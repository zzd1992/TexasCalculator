#ifndef SOLVER_H
#define SOLVER_H

#include <iostream>
#include <cstring>
#include <vector>
#include <math.h>
#include <unordered_map>
#include <string>
#include "tables.h"

static short binaries_by_id[52] = {
    0x1,
    0x1,
    0x1,
    0x1,
    0x2,
    0x2,
    0x2,
    0x2,
    0x4,
    0x4,
    0x4,
    0x4,
    0x8,
    0x8,
    0x8,
    0x8,
    0x10,
    0x10,
    0x10,
    0x10,
    0x20,
    0x20,
    0x20,
    0x20,
    0x40,
    0x40,
    0x40,
    0x40,
    0x80,
    0x80,
    0x80,
    0x80,
    0x100,
    0x100,
    0x100,
    0x100,
    0x200,
    0x200,
    0x200,
    0x200,
    0x400,
    0x400,
    0x400,
    0x400,
    0x800,
    0x800,
    0x800,
    0x800,
    0x1000,
    0x1000,
    0x1000,
    0x1000,
};

static short suitbit_by_id[52] = {
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
    0x1,
    0x8,
    0x40,
    0x200,
};

// (num_players, card1, card2)
static double no_flush2[5][13][13] =
    {
        {
            {
                0.5033,
                0.323,
                0.332,
                0.3428,
                0.3408,
                0.3458,
                0.3683,
                0.391,
                0.4167,
                0.4435,
                0.473,
                0.5051,
                0.5493,
            },
            {
                0.323,
                0.5369,
                0.3515,
                0.3626,
                0.3608,
                0.366,
                0.3748,
                0.4002,
                0.4259,
                0.4528,
                0.4822,
                0.5143,
                0.5584,
            },
            {
                0.332,
                0.3515,
                0.5702,
                0.3816,
                0.3801,
                0.3855,
                0.3945,
                0.4067,
                0.435,
                0.4619,
                0.4913,
                0.5233,
                0.5673,
            },
            {
                0.3428,
                0.3626,
                0.3816,
                0.6032,
                0.3994,
                0.4051,
                0.4143,
                0.4267,
                0.4425,
                0.4718,
                0.5012,
                0.5331,
                0.577,
            },
            {
                0.3408,
                0.3608,
                0.3801,
                0.3994,
                0.6328,
                0.4232,
                0.4324,
                0.4449,
                0.4609,
                0.4784,
                0.5102,
                0.5422,
                0.5768,
            },
            {
                0.3458,
                0.366,
                0.3855,
                0.4051,
                0.4232,
                0.6624,
                0.4505,
                0.463,
                0.4791,
                0.4968,
                0.5177,
                0.5519,
                0.5884,
            },
            {
                0.3683,
                0.3748,
                0.3945,
                0.4143,
                0.4324,
                0.4505,
                0.6916,
                0.481,
                0.4972,
                0.5149,
                0.536,
                0.5602,
                0.5987,
            },
            {
                0.391,
                0.4002,
                0.4067,
                0.4267,
                0.4449,
                0.463,
                0.481,
                0.7206,
                0.5153,
                0.5325,
                0.5536,
                0.5781,
                0.6077,
            },
            {
                0.4167,
                0.4259,
                0.435,
                0.4425,
                0.4609,
                0.4791,
                0.4972,
                0.5153,
                0.7501,
                0.5525,
                0.5729,
                0.5974,
                0.6272,
            },
            {
                0.4435,
                0.4528,
                0.4619,
                0.4718,
                0.4784,
                0.4968,
                0.5149,
                0.5325,
                0.5525,
                0.7747,
                0.5813,
                0.6057,
                0.6356,
            },
            {
                0.473,
                0.4822,
                0.4913,
                0.5012,
                0.5102,
                0.5177,
                0.536,
                0.5536,
                0.5729,
                0.5813,
                0.7993,
                0.6146,
                0.6443,
            },
            {
                0.5051,
                0.5143,
                0.5233,
                0.5331,
                0.5422,
                0.5519,
                0.5602,
                0.5781,
                0.5974,
                0.6057,
                0.6146,
                0.824,
                0.6532,
            },
            {
                0.5493,
                0.5584,
                0.5673,
                0.577,
                0.5768,
                0.5884,
                0.5987,
                0.6077,
                0.6272,
                0.6356,
                0.6443,
                0.6532,
                0.852,
            },
        },
        {
            {
                0.3374,
                0.2161,
                0.2253,
                0.2337,
                0.2271,
                0.2252,
                0.2397,
                0.2543,
                0.2725,
                0.2919,
                0.3151,
                0.3425,
                0.3848,
            },
            {
                0.2161,
                0.369,
                0.2446,
                0.2538,
                0.2475,
                0.2454,
                0.2458,
                0.2629,
                0.2812,
                0.3008,
                0.3241,
                0.3517,
                0.3948,
            },
            {
                0.2253,
                0.2446,
                0.4018,
                0.273,
                0.2675,
                0.2657,
                0.266,
                0.2691,
                0.2899,
                0.3096,
                0.3331,
                0.3609,
                0.4043,
            },
            {
                0.2337,
                0.2538,
                0.273,
                0.4359,
                0.2869,
                0.286,
                0.2865,
                0.2896,
                0.2967,
                0.319,
                0.3427,
                0.3708,
                0.4145,
            },
            {
                0.2271,
                0.2475,
                0.2675,
                0.2869,
                0.4678,
                0.3053,
                0.3066,
                0.31,
                0.3171,
                0.3259,
                0.3522,
                0.3804,
                0.4122,
            },
            {
                0.2252,
                0.2454,
                0.2657,
                0.286,
                0.3053,
                0.5008,
                0.3264,
                0.3306,
                0.3381,
                0.347,
                0.3603,
                0.3911,
                0.4254,
            },
            {
                0.2397,
                0.2458,
                0.266,
                0.2865,
                0.3066,
                0.3264,
                0.5353,
                0.3509,
                0.3596,
                0.3686,
                0.3822,
                0.4007,
                0.4375,
            },
            {
                0.2543,
                0.2629,
                0.2691,
                0.2896,
                0.31,
                0.3306,
                0.3509,
                0.5711,
                0.3814,
                0.3905,
                0.4043,
                0.4231,
                0.4484,
            },
            {
                0.2725,
                0.2812,
                0.2899,
                0.2967,
                0.3171,
                0.3381,
                0.3596,
                0.3814,
                0.6095,
                0.4162,
                0.4298,
                0.4488,
                0.4744,
            },
            {
                0.2919,
                0.3008,
                0.3096,
                0.319,
                0.3259,
                0.347,
                0.3686,
                0.3905,
                0.4162,
                0.6436,
                0.4409,
                0.46,
                0.486,
            },
            {
                0.3151,
                0.3241,
                0.3331,
                0.3427,
                0.3522,
                0.3603,
                0.3822,
                0.4043,
                0.4298,
                0.4409,
                0.6789,
                0.4723,
                0.4983,
            },
            {
                0.3425,
                0.3517,
                0.3609,
                0.3708,
                0.3804,
                0.3911,
                0.4007,
                0.4231,
                0.4488,
                0.46,
                0.4723,
                0.7155,
                0.5114,
            },
            {
                0.3848,
                0.3948,
                0.4043,
                0.4145,
                0.4122,
                0.4254,
                0.4375,
                0.4484,
                0.4744,
                0.486,
                0.4983,
                0.5114,
                0.7578,
            },
        },
        {
            {
                0.2569,
                0.1644,
                0.173,
                0.1804,
                0.1731,
                0.1695,
                0.1805,
                0.1913,
                0.2055,
                0.2201,
                0.2384,
                0.261,
                0.2982,
            },
            {
                0.1644,
                0.2823,
                0.1907,
                0.1993,
                0.1922,
                0.1882,
                0.186,
                0.1989,
                0.2132,
                0.228,
                0.2465,
                0.2692,
                0.3076,
            },
            {
                0.173,
                0.1907,
                0.3101,
                0.2171,
                0.2112,
                0.2075,
                0.205,
                0.2046,
                0.221,
                0.2359,
                0.2545,
                0.2775,
                0.3165,
            },
            {
                0.1804,
                0.1993,
                0.2171,
                0.3401,
                0.2293,
                0.2268,
                0.2246,
                0.224,
                0.2272,
                0.2442,
                0.2631,
                0.2864,
                0.3258,
            },
            {
                0.1731,
                0.1922,
                0.2112,
                0.2293,
                0.3693,
                0.2454,
                0.2443,
                0.244,
                0.247,
                0.2509,
                0.272,
                0.2955,
                0.322,
            },
            {
                0.1695,
                0.1882,
                0.2075,
                0.2268,
                0.2454,
                0.4006,
                0.2635,
                0.2644,
                0.268,
                0.2718,
                0.2799,
                0.3058,
                0.3348,
            },
            {
                0.1805,
                0.186,
                0.205,
                0.2246,
                0.2443,
                0.2635,
                0.4345,
                0.2846,
                0.2897,
                0.2938,
                0.302,
                0.3152,
                0.3468,
            },
            {
                0.1913,
                0.1989,
                0.2046,
                0.224,
                0.244,
                0.2644,
                0.2846,
                0.471,
                0.3124,
                0.3166,
                0.3251,
                0.3386,
                0.3581,
            },
            {
                0.2055,
                0.2132,
                0.221,
                0.2272,
                0.247,
                0.268,
                0.2897,
                0.3124,
                0.5117,
                0.3445,
                0.353,
                0.3669,
                0.3866,
            },
            {
                0.2201,
                0.228,
                0.2359,
                0.2442,
                0.2509,
                0.2718,
                0.2938,
                0.3166,
                0.3445,
                0.5498,
                0.3652,
                0.3793,
                0.3995,
            },
            {
                0.2384,
                0.2465,
                0.2545,
                0.2631,
                0.272,
                0.2799,
                0.302,
                0.3251,
                0.353,
                0.3652,
                0.5905,
                0.3934,
                0.4137,
            },
            {
                0.261,
                0.2692,
                0.2775,
                0.2864,
                0.2955,
                0.3058,
                0.3152,
                0.3386,
                0.3669,
                0.3793,
                0.3934,
                0.634,
                0.4294,
            },
            {
                0.2982,
                0.3076,
                0.3165,
                0.3258,
                0.322,
                0.3348,
                0.3468,
                0.3581,
                0.3866,
                0.3995,
                0.4137,
                0.4294,
                0.6849,
            },
        },
        {
            {
                0.2125,
                0.134,
                0.1418,
                0.1483,
                0.1406,
                0.1364,
                0.1454,
                0.1543,
                0.1664,
                0.1783,
                0.1935,
                0.2128,
                0.2455,
            },
            {
                0.134,
                0.2321,
                0.1578,
                0.1658,
                0.1583,
                0.1535,
                0.1503,
                0.1608,
                0.1731,
                0.1851,
                0.2004,
                0.2199,
                0.2541,
            },
            {
                0.1418,
                0.1578,
                0.2545,
                0.1821,
                0.1759,
                0.1715,
                0.1678,
                0.166,
                0.1799,
                0.192,
                0.2075,
                0.2271,
                0.2621,
            },
            {
                0.1483,
                0.1658,
                0.1821,
                0.2796,
                0.1926,
                0.1895,
                0.1862,
                0.184,
                0.1855,
                0.1993,
                0.2151,
                0.2349,
                0.2704,
            },
            {
                0.1406,
                0.1583,
                0.1759,
                0.1926,
                0.3052,
                0.2067,
                0.2047,
                0.2029,
                0.2041,
                0.2055,
                0.2231,
                0.2432,
                0.2655,
            },
            {
                0.1364,
                0.1535,
                0.1715,
                0.1895,
                0.2067,
                0.3332,
                0.2228,
                0.2224,
                0.2242,
                0.2254,
                0.2305,
                0.2527,
                0.2774,
            },
            {
                0.1454,
                0.1503,
                0.1678,
                0.1862,
                0.2047,
                0.2228,
                0.3646,
                0.2417,
                0.2454,
                0.2468,
                0.252,
                0.2618,
                0.2888,
            },
            {
                0.1543,
                0.1608,
                0.166,
                0.184,
                0.2029,
                0.2224,
                0.2417,
                0.3995,
                0.2678,
                0.2694,
                0.2749,
                0.285,
                0.2999,
            },
            {
                0.1664,
                0.1731,
                0.1799,
                0.1855,
                0.2041,
                0.2242,
                0.2454,
                0.2678,
                0.4395,
                0.298,
                0.3036,
                0.314,
                0.3291,
            },
            {
                0.1783,
                0.1851,
                0.192,
                0.1993,
                0.2055,
                0.2254,
                0.2468,
                0.2694,
                0.298,
                0.479,
                0.3161,
                0.3269,
                0.3425,
            },
            {
                0.1935,
                0.2004,
                0.2075,
                0.2151,
                0.2231,
                0.2305,
                0.252,
                0.2749,
                0.3036,
                0.3161,
                0.5222,
                0.3419,
                0.3577,
            },
            {
                0.2128,
                0.2199,
                0.2271,
                0.2349,
                0.2432,
                0.2527,
                0.2618,
                0.285,
                0.314,
                0.3269,
                0.3419,
                0.5695,
                0.375,
            },
            {
                0.2455,
                0.2541,
                0.2621,
                0.2704,
                0.2655,
                0.2774,
                0.2888,
                0.2999,
                0.3291,
                0.3425,
                0.3577,
                0.375,
                0.6255,
            },
        },
        {
            {
                0.1858,
                0.1143,
                0.1214,
                0.1271,
                0.1191,
                0.1145,
                0.1221,
                0.1297,
                0.1406,
                0.1507,
                0.1639,
                0.1809,
                0.2102,
            },
            {
                0.1143,
                0.2007,
                0.1359,
                0.1433,
                0.1354,
                0.1302,
                0.1264,
                0.1353,
                0.1462,
                0.1565,
                0.1699,
                0.187,
                0.218,
            },
            {
                0.1214,
                0.1359,
                0.2185,
                0.1581,
                0.1519,
                0.1468,
                0.1425,
                0.1399,
                0.1521,
                0.1626,
                0.176,
                0.1933,
                0.2251,
            },
            {
                0.1271,
                0.1433,
                0.1581,
                0.239,
                0.1671,
                0.1637,
                0.1596,
                0.1566,
                0.1572,
                0.169,
                0.1826,
                0.2002,
                0.2325,
            },
            {
                0.1191,
                0.1354,
                0.1519,
                0.1671,
                0.2612,
                0.1794,
                0.177,
                0.1743,
                0.1746,
                0.1747,
                0.1898,
                0.2076,
                0.2269,
            },
            {
                0.1145,
                0.1302,
                0.1468,
                0.1637,
                0.1794,
                0.2856,
                0.1938,
                0.1927,
                0.1936,
                0.1934,
                0.1968,
                0.2163,
                0.2377,
            },
            {
                0.1221,
                0.1264,
                0.1425,
                0.1596,
                0.177,
                0.1938,
                0.314,
                0.2109,
                0.2139,
                0.2139,
                0.2172,
                0.2249,
                0.2484,
            },
            {
                0.1297,
                0.1353,
                0.1399,
                0.1566,
                0.1743,
                0.1927,
                0.2109,
                0.3463,
                0.2356,
                0.2358,
                0.2394,
                0.2473,
                0.2591,
            },
            {
                0.1406,
                0.1462,
                0.1521,
                0.1572,
                0.1746,
                0.1936,
                0.2139,
                0.2356,
                0.3845,
                0.2642,
                0.2681,
                0.2763,
                0.2882,
            },
            {
                0.1507,
                0.1565,
                0.1626,
                0.169,
                0.1747,
                0.1934,
                0.2139,
                0.2358,
                0.2642,
                0.4236,
                0.2806,
                0.2893,
                0.3017,
            },
            {
                0.1639,
                0.1699,
                0.176,
                0.1826,
                0.1898,
                0.1968,
                0.2172,
                0.2394,
                0.2681,
                0.2806,
                0.4675,
                0.3046,
                0.3173,
            },
            {
                0.1809,
                0.187,
                0.1933,
                0.2002,
                0.2076,
                0.2163,
                0.2249,
                0.2473,
                0.2763,
                0.2893,
                0.3046,
                0.5167,
                0.3356,
            },
            {
                0.2102,
                0.218,
                0.2251,
                0.2325,
                0.2269,
                0.2377,
                0.2484,
                0.2591,
                0.2882,
                0.3017,
                0.3173,
                0.3356,
                0.5757,
            },
        },
};
static double flush2[5][13][13] =
    {
        {
            {
                0,
                0.3598,
                0.3683,
                0.3785,
                0.3767,
                0.3816,
                0.4027,
                0.4242,
                0.4484,
                0.4738,
                0.5017,
                0.5321,
                0.5738,
            },
            {
                0.3598,
                0,
                0.3864,
                0.3969,
                0.3953,
                0.4004,
                0.4087,
                0.4326,
                0.4569,
                0.4823,
                0.5102,
                0.5405,
                0.5822,
            },
            {
                0.3683,
                0.3864,
                0,
                0.4145,
                0.4133,
                0.4185,
                0.427,
                0.4386,
                0.4653,
                0.4907,
                0.5186,
                0.5488,
                0.5903,
            },
            {
                0.3785,
                0.3969,
                0.4145,
                0,
                0.4313,
                0.4368,
                0.4454,
                0.4572,
                0.4722,
                0.4999,
                0.5277,
                0.5579,
                0.5992,
            },
            {
                0.3767,
                0.3953,
                0.4133,
                0.4313,
                0,
                0.4537,
                0.4624,
                0.4743,
                0.4894,
                0.5061,
                0.5361,
                0.5664,
                0.5991,
            },
            {
                0.3816,
                0.4004,
                0.4185,
                0.4368,
                0.4537,
                0,
                0.4794,
                0.4912,
                0.5064,
                0.5232,
                0.543,
                0.5754,
                0.6098,
            },
            {
                0.4027,
                0.4087,
                0.427,
                0.4454,
                0.4624,
                0.4794,
                0,
                0.508,
                0.5233,
                0.5402,
                0.5602,
                0.5831,
                0.6194,
            },
            {
                0.4242,
                0.4326,
                0.4386,
                0.4572,
                0.4743,
                0.4912,
                0.508,
                0,
                0.5403,
                0.5566,
                0.5766,
                0.5999,
                0.6278,
            },
            {
                0.4484,
                0.4569,
                0.4653,
                0.4722,
                0.4894,
                0.5064,
                0.5233,
                0.5403,
                0,
                0.5753,
                0.5947,
                0.6179,
                0.646,
            },
            {
                0.4738,
                0.4823,
                0.4907,
                0.4999,
                0.5061,
                0.5232,
                0.5402,
                0.5566,
                0.5753,
                0,
                0.6026,
                0.6257,
                0.6539,
            },
            {
                0.5017,
                0.5102,
                0.5186,
                0.5277,
                0.5361,
                0.543,
                0.5602,
                0.5766,
                0.5947,
                0.6026,
                0,
                0.634,
                0.6621,
            },
            {
                0.5321,
                0.5405,
                0.5488,
                0.5579,
                0.5664,
                0.5754,
                0.5831,
                0.5999,
                0.6179,
                0.6257,
                0.634,
                0,
                0.6704,
            },
            {
                0.5738,
                0.5822,
                0.5903,
                0.5992,
                0.5991,
                0.6098,
                0.6194,
                0.6278,
                0.646,
                0.6539,
                0.6621,
                0.6704,
                0,
            },
        },
        {
            {
                0,
                0.2564,
                0.265,
                0.2729,
                0.267,
                0.2654,
                0.2793,
                0.2932,
                0.3106,
                0.3293,
                0.3516,
                0.378,
                0.4181,
            },
            {
                0.2564,
                0,
                0.2829,
                0.2916,
                0.2858,
                0.2841,
                0.2848,
                0.3011,
                0.3186,
                0.3374,
                0.3599,
                0.3864,
                0.4273,
            },
            {
                0.265,
                0.2829,
                0,
                0.3093,
                0.3044,
                0.3029,
                0.3034,
                0.3066,
                0.3265,
                0.3455,
                0.3681,
                0.3947,
                0.4359,
            },
            {
                0.2729,
                0.2916,
                0.3093,
                0,
                0.3224,
                0.3217,
                0.3224,
                0.3256,
                0.3326,
                0.354,
                0.3769,
                0.4037,
                0.4452,
            },
            {
                0.267,
                0.2858,
                0.3044,
                0.3224,
                0,
                0.3398,
                0.3412,
                0.3447,
                0.3517,
                0.3604,
                0.3856,
                0.4127,
                0.443,
            },
            {
                0.2654,
                0.2841,
                0.3029,
                0.3217,
                0.3398,
                0,
                0.3597,
                0.3639,
                0.3713,
                0.3801,
                0.3931,
                0.4226,
                0.4552,
            },
            {
                0.2793,
                0.2848,
                0.3034,
                0.3224,
                0.3412,
                0.3597,
                0,
                0.3828,
                0.3912,
                0.4002,
                0.4135,
                0.4314,
                0.4664,
            },
            {
                0.2932,
                0.3011,
                0.3066,
                0.3256,
                0.3447,
                0.3639,
                0.3828,
                0,
                0.4115,
                0.4205,
                0.434,
                0.4523,
                0.4765,
            },
            {
                0.3106,
                0.3186,
                0.3265,
                0.3326,
                0.3517,
                0.3713,
                0.3912,
                0.4115,
                0,
                0.4445,
                0.4577,
                0.4761,
                0.5007,
            },
            {
                0.3293,
                0.3374,
                0.3455,
                0.354,
                0.3604,
                0.3801,
                0.4002,
                0.4205,
                0.4445,
                0,
                0.4681,
                0.4866,
                0.5115,
            },
            {
                0.3516,
                0.3599,
                0.3681,
                0.3769,
                0.3856,
                0.3931,
                0.4135,
                0.434,
                0.4577,
                0.4681,
                0,
                0.4981,
                0.523,
            },
            {
                0.378,
                0.3864,
                0.3947,
                0.4037,
                0.4127,
                0.4226,
                0.4314,
                0.4523,
                0.4761,
                0.4866,
                0.4981,
                0,
                0.5353,
            },
            {
                0.4181,
                0.4273,
                0.4359,
                0.4452,
                0.443,
                0.4552,
                0.4664,
                0.4765,
                0.5007,
                0.5115,
                0.523,
                0.5353,
                0,
            },
        },
        {
            {
                0,
                0.2058,
                0.2138,
                0.2209,
                0.2142,
                0.2111,
                0.2217,
                0.2323,
                0.246,
                0.2604,
                0.2783,
                0.3003,
                0.3359,
            },
            {
                0.2058,
                0,
                0.2302,
                0.2383,
                0.2318,
                0.2284,
                0.2266,
                0.2391,
                0.253,
                0.2675,
                0.2855,
                0.3077,
                0.3445,
            },
            {
                0.2138,
                0.2302,
                0,
                0.2548,
                0.2494,
                0.2462,
                0.2441,
                0.2442,
                0.26,
                0.2746,
                0.2928,
                0.3152,
                0.3525,
            },
            {
                0.2209,
                0.2383,
                0.2548,
                0,
                0.2661,
                0.264,
                0.2622,
                0.2621,
                0.2655,
                0.2822,
                0.3006,
                0.3232,
                0.361,
            },
            {
                0.2142,
                0.2318,
                0.2494,
                0.2661,
                0,
                0.2812,
                0.2805,
                0.2807,
                0.284,
                0.2882,
                0.3087,
                0.3316,
                0.3573,
            },
            {
                0.2111,
                0.2284,
                0.2462,
                0.264,
                0.2812,
                0,
                0.2984,
                0.2996,
                0.3034,
                0.3076,
                0.3159,
                0.341,
                0.3691,
            },
            {
                0.2217,
                0.2266,
                0.2441,
                0.2622,
                0.2805,
                0.2984,
                0,
                0.3184,
                0.3236,
                0.328,
                0.3365,
                0.3497,
                0.3801,
            },
            {
                0.2323,
                0.2391,
                0.2442,
                0.2621,
                0.2807,
                0.2996,
                0.3184,
                0,
                0.3445,
                0.3492,
                0.3579,
                0.3715,
                0.3905,
            },
            {
                0.246,
                0.253,
                0.26,
                0.2655,
                0.284,
                0.3034,
                0.3236,
                0.3445,
                0,
                0.375,
                0.3838,
                0.3976,
                0.4169,
            },
            {
                0.2604,
                0.2675,
                0.2746,
                0.2822,
                0.2882,
                0.3076,
                0.328,
                0.3492,
                0.375,
                0,
                0.3951,
                0.4091,
                0.4288,
            },
            {
                0.2783,
                0.2855,
                0.2928,
                0.3006,
                0.3087,
                0.3159,
                0.3365,
                0.3579,
                0.3838,
                0.3951,
                0,
                0.4222,
                0.4421,
            },
            {
                0.3003,
                0.3077,
                0.3152,
                0.3232,
                0.3316,
                0.341,
                0.3497,
                0.3715,
                0.3976,
                0.4091,
                0.4222,
                0,
                0.4566,
            },
            {
                0.3359,
                0.3445,
                0.3525,
                0.361,
                0.3573,
                0.3691,
                0.3801,
                0.3905,
                0.4169,
                0.4288,
                0.4421,
                0.4566,
                0,
            },
        },
        {
            {
                0,
                0.1758,
                0.183,
                0.1892,
                0.1821,
                0.1785,
                0.1873,
                0.1961,
                0.208,
                0.2198,
                0.235,
                0.254,
                0.2856,
            },
            {
                0.1758,
                0,
                0.1978,
                0.2052,
                0.1984,
                0.1943,
                0.1916,
                0.2019,
                0.2139,
                0.2259,
                0.2412,
                0.2604,
                0.2934,
            },
            {
                0.183,
                0.1978,
                0,
                0.2202,
                0.2147,
                0.2108,
                0.2077,
                0.2065,
                0.22,
                0.2322,
                0.2476,
                0.2669,
                0.3006,
            },
            {
                0.1892,
                0.2052,
                0.2202,
                0,
                0.23,
                0.2274,
                0.2246,
                0.223,
                0.2249,
                0.2387,
                0.2543,
                0.2739,
                0.3081,
            },
            {
                0.1821,
                0.1984,
                0.2147,
                0.23,
                0,
                0.2433,
                0.2418,
                0.2406,
                0.2422,
                0.2443,
                0.2616,
                0.2815,
                0.3034,
            },
            {
                0.1785,
                0.1943,
                0.2108,
                0.2274,
                0.2433,
                0,
                0.2585,
                0.2586,
                0.2608,
                0.2627,
                0.2684,
                0.2902,
                0.3143,
            },
            {
                0.1873,
                0.1916,
                0.2077,
                0.2246,
                0.2418,
                0.2585,
                0,
                0.2764,
                0.2804,
                0.2825,
                0.2882,
                0.2985,
                0.3247,
            },
            {
                0.1961,
                0.2019,
                0.2065,
                0.223,
                0.2406,
                0.2586,
                0.2764,
                0,
                0.301,
                0.3034,
                0.3094,
                0.3199,
                0.3349,
            },
            {
                0.208,
                0.2139,
                0.22,
                0.2249,
                0.2422,
                0.2608,
                0.2804,
                0.301,
                0,
                0.3297,
                0.3359,
                0.3467,
                0.3619,
            },
            {
                0.2198,
                0.2259,
                0.2322,
                0.2387,
                0.2443,
                0.2627,
                0.2825,
                0.3034,
                0.3297,
                0,
                0.3474,
                0.3586,
                0.3742,
            },
            {
                0.235,
                0.2412,
                0.2476,
                0.2543,
                0.2616,
                0.2684,
                0.2882,
                0.3094,
                0.3359,
                0.3474,
                0,
                0.3724,
                0.3883,
            },
            {
                0.254,
                0.2604,
                0.2669,
                0.2739,
                0.2815,
                0.2902,
                0.2985,
                0.3199,
                0.3467,
                0.3586,
                0.3724,
                0,
                0.4042,
            },
            {
                0.2856,
                0.2934,
                0.3006,
                0.3081,
                0.3034,
                0.3143,
                0.3247,
                0.3349,
                0.3619,
                0.3742,
                0.3883,
                0.4042,
                0,
            },
        },
        {
            {
                0,
                0.1559,
                0.1625,
                0.1679,
                0.1606,
                0.1566,
                0.1641,
                0.1718,
                0.1825,
                0.1929,
                0.2062,
                0.2232,
                0.2518,
            },
            {
                0.1559,
                0,
                0.1759,
                0.1828,
                0.1757,
                0.171,
                0.1679,
                0.1767,
                0.1876,
                0.1981,
                0.2115,
                0.2287,
                0.2588,
            },
            {
                0.1625,
                0.1759,
                0,
                0.1965,
                0.1908,
                0.1864,
                0.1827,
                0.1808,
                0.1928,
                0.2034,
                0.217,
                0.2343,
                0.2652,
            },
            {
                0.1679,
                0.1828,
                0.1965,
                0,
                0.2048,
                0.2018,
                0.1984,
                0.1961,
                0.1973,
                0.2091,
                0.2229,
                0.2404,
                0.2718,
            },
            {
                0.1606,
                0.1757,
                0.1908,
                0.2048,
                0,
                0.2164,
                0.2145,
                0.2125,
                0.2133,
                0.2142,
                0.2294,
                0.2472,
                0.2665,
            },
            {
                0.1566,
                0.171,
                0.1864,
                0.2018,
                0.2164,
                0,
                0.23,
                0.2295,
                0.2308,
                0.2315,
                0.2357,
                0.2551,
                0.2763,
            },
            {
                0.1641,
                0.1679,
                0.1827,
                0.1984,
                0.2145,
                0.23,
                0,
                0.2462,
                0.2496,
                0.2504,
                0.2545,
                0.2629,
                0.286,
            },
            {
                0.1718,
                0.1767,
                0.1808,
                0.1961,
                0.2125,
                0.2295,
                0.2462,
                0,
                0.2695,
                0.2706,
                0.275,
                0.2836,
                0.2958,
            },
            {
                0.1825,
                0.1876,
                0.1928,
                0.1973,
                0.2133,
                0.2308,
                0.2496,
                0.2695,
                0,
                0.2968,
                0.3014,
                0.3103,
                0.3226,
            },
            {
                0.1929,
                0.1981,
                0.2034,
                0.2091,
                0.2142,
                0.2315,
                0.2504,
                0.2706,
                0.2968,
                0,
                0.3128,
                0.3221,
                0.3349,
            },
            {
                0.2062,
                0.2115,
                0.217,
                0.2229,
                0.2294,
                0.2357,
                0.2545,
                0.275,
                0.3014,
                0.3128,
                0,
                0.3362,
                0.3493,
            },
            {
                0.2232,
                0.2287,
                0.2343,
                0.2404,
                0.2472,
                0.2551,
                0.2629,
                0.2836,
                0.3103,
                0.3221,
                0.3362,
                0,
                0.3661,
            },
            {
                0.2518,
                0.2588,
                0.2652,
                0.2718,
                0.2665,
                0.2763,
                0.286,
                0.2958,
                0.3226,
                0.3349,
                0.3493,
                0.3661,
                0,
            },
        },
};

const static std::unordered_map<char, uint8_t> rankMap = {
    {'2', 0},
    {'3', 1},
    {'4', 2},
    {'5', 3},
    {'6', 4},
    {'7', 5},
    {'8', 6},
    {'9', 7},
    {'T', 8},
    {'J', 9},
    {'Q', 10},
    {'K', 11},
    {'A', 12},
};

const static std::unordered_map<char, uint8_t> suitMap = {
    {'C', 0},
    {'D', 1},
    {'H', 2},
    {'S', 3},
    {'c', 0},
    {'d', 1},
    {'h', 2},
    {'s', 3},
};

/*
    card coding:
    |      |    C |    D |    H |    S |
    | ---: | ---: | ---: | ---: | ---: |
    |    2 |    0 |    1 |    2 |    3 |
    |    3 |    4 |    5 |    6 |    7 |
    |    4 |    8 |    9 |   10 |   11 |
    |    5 |   12 |   13 |   14 |   15 |
    |    6 |   16 |   17 |   18 |   19 |
    |    7 |   20 |   21 |   22 |   23 |
    |    8 |   24 |   25 |   26 |   27 |
    |    9 |   28 |   29 |   30 |   31 |
    |    T |   32 |   33 |   34 |   35 |
    |    J |   36 |   37 |   38 |   39 |
    |    Q |   40 |   41 |   42 |   43 |
    |    K |   44 |   45 |   46 |   47 |
    |    A |   48 |   49 |   50 |   51 |
*/

class TexasSolver
{
private:
    int n_players = 2;
    bool mask[52];
    int hash_quinary(const unsigned char[], int);

    inline double get_prob(int n_win, int n_tie)
    {
        double n = static_cast<double>(n_win) + 0.5 * static_cast<double>(n_tie);
        return pow(n / 990, pow(n_players - 1, 0.85));
    };

public:
    TexasSolver();
    void set_number_players(int);
    int rank_7card(uint8_t, uint8_t, uint8_t, uint8_t, uint8_t, uint8_t, uint8_t);
    double prob_7card(uint8_t, uint8_t, uint8_t, uint8_t, uint8_t, uint8_t, uint8_t);
    double prob_6card(uint8_t, uint8_t, uint8_t, uint8_t, uint8_t, uint8_t);
    double prob_5card(uint8_t, uint8_t, uint8_t, uint8_t, uint8_t);
    double prob_2card(uint8_t, uint8_t);
    uint8_t card2id(char*);
};

#endif // SOLVER_H
